<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Partial torus mesh | Stride Community Toolkit Manual </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Partial torus mesh | Stride Community Toolkit Manual ">
      
      
      <link rel="icon" href="../../../favicon.ico">
      <link rel="stylesheet" href="../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../public/main.css">
      <meta name="docfx:navrel" content="../../../toc.html">
      <meta name="docfx:tocrel" content="../../toc.html">
      
      <meta name="docfx:rel" content="../../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/stride3d/stride-community-toolkit/blob/main/docs/manual/code-only/examples/partial-torus-mesh-fs.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../index.html">
            <img id="logo" class="svg" src="../../../media/stride-logo-blue-toolkit.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="partial-torus-mesh">Partial torus mesh</h1>

<p>This example demonstrates creating a 3D partial torus mesh programmatically by breaking down
the process into clear, distinct steps:</p>
<ol>
<li>Setting up a basic 3D scene with a skybox</li>
<li>Creating a parametrically defined torus geometry using mathematical formulas</li>
<li>Demonstrating how to generate a partial (incomplete) torus by constraining the bend angle</li>
<li>Building structured 3D mesh generation with proper vertex positioning and normal definitions</li>
</ol>
<p>The example showcases important 3D graphics concepts including:</p>
<ul>
<li>Parametric surface generation using two angle parameters (circumference and bend)</li>
<li>Correct normal calculation for accurate lighting and shading</li>
<li>Triangle winding order for proper face orientation</li>
<li>Vertex indexing to efficiently reuse vertices between adjacent triangles</li>
</ul>
<p><img src="media/stride-game-engine-example-05-partial-torus-mesh.webp" alt="Stride UI Example"></p>
<p>For more details of <code>MeshBuilder</code>, refer to our <a href="../../rendering/mesh-builder.html">MeshBuilder manual</a>.</p>
<div class="TIP">
<h5>Tip</h5>
<p>Notice the effect of back-face culling when moving the camera around the objects. With the default culling mode enabled, back faces are not rendered, optimizing performance by avoiding the drawing of surfaces that are not visible to the camera.</p>
<p>For open or partially open 3D models, viewing from inside or even from outside through an open area may cause the model to appear incomplete. This is normal behavior since back-face culling intentionally omits surfaces facing away from the camera.</p>
</div>
<div class="NOTE">
<h5>Note</h5>
<p>This example requires the additional NuGet packages <code>Stride.CommunityToolkit.Skyboxes</code> and <code>Stride.CommunityToolkit.Bepu</code>. Make sure to install <strong>both</strong> before running the code.</p>
</div>

<p>View on <a href="https://github.com/stride3d/stride-community-toolkit/tree/main/examples/code-only/Example05_PartialTorus_FSharp">GitHub</a>.</p>
<pre><code class="lang-csharp">open Stride.CommunityToolkit.Bepu;
open Stride.CommunityToolkit.Engine;
open Stride.CommunityToolkit.Skyboxes;
open Stride.Core.Mathematics;
open Stride.Engine;
open Stride.CommunityToolkit.Rendering.Utilities
open Stride.Graphics
open System
open Stride.Rendering
open Stride.Rendering.Materials
open Stride.Rendering.Materials.ComputeColors

let game = new Game()

let CreateMaterial (game: Game) : Material =
    Material.New(
        game.GraphicsDevice,
        MaterialDescriptor(
            Attributes = MaterialAttributes(
                    MicroSurface =  MaterialGlossinessMapFeature(GlossinessMap = ComputeFloat(0.9f)),
                    Diffuse = MaterialDiffuseMapFeature(DiffuseMap = ComputeColor(Color4(1.0f, 0.3f, 0.5f, 1.0f))),
                    DiffuseModel = MaterialDiffuseLambertModelFeature(),
                    Specular = MaterialMetalnessMapFeature(MetalnessMap = ComputeFloat(0.0f)),
                    SpecularModel = MaterialSpecularMicrofacetModelFeature(
                            Environment = MaterialSpecularMicrofacetEnvironmentGGXPolynomial()
                        )
                )
        )
    )

let CreateMeshEntity (graphicsDevice:GraphicsDevice) (scene:Scene) (position:Vector3) (build:MeshBuilder -&gt; unit) =
    use meshBuilder = new MeshBuilder()

    build(meshBuilder)

    let model = new Model()
    model.Add(MaterialInstance(Material = CreateMaterial(game)))
    model.Add(Mesh(
        Draw = meshBuilder.ToMeshDraw(graphicsDevice),
        MaterialIndex = 0
    ))

    let entity = new Entity()
    entity.Scene &lt;- scene
    entity.Transform.Position &lt;- position
    entity.Add(ModelComponent(Model = model))
    entity

let BuildPartialTorusMesh (meshBuilder:MeshBuilder) cylinderRadius torusAngle bendRadius circumferenceStepsCount bendSegmentSteps =
    //for partial torus up to 360 degrees (tAngle in degrees)
    meshBuilder.WithIndexType(IndexingType.Int16) |&gt; ignore
    meshBuilder.WithPrimitiveType(PrimitiveType.TriangleList)  |&gt; ignore

    let position = meshBuilder.WithPosition&lt;Vector3&gt;()
    let normal = meshBuilder.WithNormal&lt;Vector3&gt;()

    //vertices
    for j in 0..bendSegmentSteps do
      //Torus angle position Phi starts at 0 in line with Z-axis and increases to Pi/2 at X-axis
      let tPhi = (float j) * torusAngle / (float bendSegmentSteps) * Math.PI / 180.0
      let xc = bendRadius * Math.Sin(tPhi)
      let zc = bendRadius * Math.Cos(tPhi)

      for i in 0..(circumferenceStepsCount - 1) do
      //circumference angle tTheta
        let tTheta = float i * Math.Tau / float circumferenceStepsCount
        let yr = cylinderRadius * Math.Sin(tTheta)

        let xr = cylinderRadius * Math.Cos(tTheta) * Math.Sin(tPhi)
        let zr = cylinderRadius * Math.Cos(tTheta) * Math.Cos(tPhi)

        let tNorm = Vector3(float32 xr, float32 yr, float32 zr)
        let tPos = Vector3(float32 (xc + xr), float32 yr, float32 (zc + zr))

        meshBuilder.AddVertex() |&gt; ignore
        meshBuilder.SetElement(position, tPos)
        meshBuilder.SetElement(normal, tNorm)

    //triangle eles
    for j in 0..(bendSegmentSteps - 1) do
      for i in 0..(circumferenceStepsCount - 1) do

        let i_tot = i + j * circumferenceStepsCount
        //build triangles
        let i_next = (i + 1) % circumferenceStepsCount + j * circumferenceStepsCount

        //triangle 1
        meshBuilder.AddIndex(i_tot)
        meshBuilder.AddIndex(i_next + circumferenceStepsCount)
        meshBuilder.AddIndex(i_tot + circumferenceStepsCount)


        //triangle 2
        meshBuilder.AddIndex(i_tot)
        meshBuilder.AddIndex(i_next)
        meshBuilder.AddIndex(i_next + circumferenceStepsCount)

let Start rootScene =
    game.SetupBase3DScene()
    game.AddSkybox() |&gt; ignore
    game.AddProfiler() |&gt; ignore

    // Torus parameters
    let cylinderRadius = 0.3f
    let torusAngle = 270.0f
    let bendRadius = 1.0f
    let circumferenceStepsCount = 20
    let bendSegmentSteps = 40

    // Create torus mesh entity
    CreateMeshEntity
        game.GraphicsDevice
        rootScene
        (Vector3(0.0f, 1.0f, 0.0f))
        (fun b -&gt; BuildPartialTorusMesh b (float cylinderRadius) (float torusAngle) (float bendRadius) circumferenceStepsCount bendSegmentSteps)
    |&gt; ignore

[&lt;EntryPoint&gt;]
let main argv =
    game.Run(start = Start)
    0
</code></pre>
</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/stride3d/stride-community-toolkit/blob/main/docs/manual/code-only/examples/partial-torus-mesh-fs.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <div class="d-flex flex-column flex-sm-row justify-content-between pt-1 text-center small"><p>Supported by the <a href="https://dotnetfoundation.org/" target="_blank" rel="noopener">.NET Foundation</a></p><p>Made with <a href="https://dotnet.github.io/docfx">docfx</a></p><p>Stride Community Toolkit Website v.1.0.0.6</p><p>&copy; .NET Foundation and Contributors</p></div>
        </div>
      </div>
    </footer>
  </body>
</html>
